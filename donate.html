<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>zeroHunger | Donate Food</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="stylesheet" href="css/donate.css" type="text/css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Paytone+One&family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css" crossorigin>
  <!-- Validation css -->
  <style>
    .is-invalid {
      border-color: red;
    }
    .error-message {
      color: red;
      font-size: 0.875em;
    }
  </style>
</head>

<body>
  <!--Header-->
  <nav class="navbar navbar-expand-sm bg-white text-dark justify-content-center fixed-top">
    <div class="container-fluid justify-content-space-between">
      <div id="logo">zero<a class="navbar-brand" href="index.html" translate="no" id="logo-s">Hunger</a></div>
      <button class="navbar-toggler border-white" type="button" data-bs-toggle="collapse"
        data-bs-target="#collapsibleNavbar">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="collapsibleNavbar">
        <ul class="navbar-nav align-items-center fw-bold" style="text-transform: uppercase;">
          <li class="nav-item" style="white-space: nowrap;">
            <a class="nav-link" href="catalogue.html">Catalogue</a>
          </li>
          <li class="nav-item" style="white-space: nowrap;">
            <a class="nav-link" href="aboutus.html">About Us</a>
          </li>
          <li class="nav-item" style="white-space: nowrap;">
            <a class="nav-link" href="contactus.html">Contact Us</a>
          </li>
        </ul>
      </div>
      <!-- Fund Us Button -->
      <span class="background">
        <a href="fundus.html" class='button'>
          <svg>
            <rect x="0" y="0" fill="none" width="100%" height="100%" />
          </svg>
          Fund Us
        </a>
      </span>
    </div>
  </nav>
  <!-- Donate Form -->
  <div class="form-wrapper mt-5">
    <div class="form-side mt-2">
      <form class="my-form" id="donation-form">
        <div class="form-heading-row">
          <h1 style="text-align: center;">Donate <span style="color: #209CEE;">Food</span></h1>
        </div>
        <!-- divider line -->
        <div class="divider">
          <div class="divider-line"></div>
        </div>
        <!-- form input fields -->
        <!-- item name -->
        <div class="text-field">
          <label for="food-name">Name of Food
            <input type="text" id="food-name" name="food-name" autocomplete="on" class="controls" spellcheck="true"
              placeholder="" required>
          </label>
          <div class="error-message" id="food-name-error"></div>
        </div>
        <!-- item type -->
        <div class="text-field">
          <label class="required" for="food-type">Food type</label>
          <select name="food-type" id="food-type" placeholder="Select the item to be donated" class="controls" required>
            <option value="">Select Food Type</option>
            <option>Cereal</option>
            <option>Meat</option>
            <option>Fish</option>
            <option>Grain</option>
            <option>Fruit</option>
            <option>Vegetable</option>
            <option>Nuts and Seed</option>
            <option>Dairy product</option>
            <option>Bread</option>
            <option>Prepared food</option>
            <option>Root vegetable (Tubers)</option>
            <option>Egg</option>
            <option>Others</option>
          </select>
          <div class="error-message" id="food-type-error"></div>
        </div>
        <!-- Manufactured Date -->
        <div class="text-field">
          <label for="mandate">Manufactured Date
            <input type="date" id="mandate" name="mandate" autocomplete="off" placeholder="" class="controls" required>
          </label>
          <div class="error-message" id="mandate-error"></div>
        </div>
        <!-- Expiry date -->
        <div class="text-field">
          <label for="expdate">Expiry Date
            <input type="date" id="expdate" name="expdate" autocomplete="off" placeholder="" class="controls" required>
          </label>
          <div class="error-message" id="expdate-error"></div>
        </div>
        <!-- Food bank centers -->
        <div class="text-field">
          <label class="required" for="foodbank-center">FoodBank Center</label>
          <select name="foodbank-center" id="foodbank-center" placeholder="Select foodbank center for donation"
            class="controls" required>
            <option value="">Select FoodBank Center</option>
            <option value="Food Bank center, KNUST">Food Bank center, KNUST</option>
            <option value="Food science department, College of Science, KNUST">Food science department, College of Science, KNUST</option>
            <option value="Faculty of Agriculture, KNUST">College of Agriculture, KNUST</option>
            <option value="Community Center, KNUST">Community Center, KNUST</option>
            <option value="Brunei Complex, KNUST">Brunei Complex, KNUST</option>
          </select>
          <div class="error-message" id="foodbank-center-error"></div>
        </div>
        <!-- pick up date -->
        <div class="text-field">
          <label for="donatedate">Available date for donation
            <input type="date" id="donatedate" name="donatedate" autocomplete="off" placeholder="" class="controls" required>
          </label>
          <div class="error-message" id="donatedate-error"></div>
        </div>
        <!-- pickup time -->
        <div class="text-field">
          <label for="time">Time for donation
            <input type="time" id="time" name="time" autocomplete="off" placeholder="" class="controls" required>
          </label>
          <div class="error-message" id="time-error"></div>
        </div>
        <!-- image upload -->
        <div class="image-upload">
          <label for="imageFile" style="font-weight: 600;">Picture of item
            <br><br><input type="file" id="imageFile" name="imageFile" class="controls" required>
          </label>
          <div class="error-message" id="imageFile-error"></div>
        </div>
        <!-- additional textarea box -->
        <textarea class="controls" maxlength="125" name="message" id="message" spellcheck="true"
          autocapitalize="true" autocomplete="on" placeholder="Additional details of item"
          title="Must contain a maximum of 125 characters" required></textarea>
        <div class="error-message" id="message-error"></div>
        
        <!-- divider line -->
        <div class="divider mt-3">
          <div class="divider-line"></div>
        </div>
        <!-- contact details -->
        <div class="form-heading-row">
          <h1 style="text-align: center;">Contact Details</h1>
        </div>
        <!-- donor name -->
        <div class="text-field">
          <label for="donor-name">Name of Donor
            <input type="text" id="donor-name" name="donor-name" autocomplete="on" spellcheck="true" placeholder=""
              class="controls" required>
          </label>
          <div class="error-message" id="donor-name-error"></div>
        </div>
        <!-- Donor phone number -->
        <div class="text-field">
          <label for="donor-phone">Phone number
            <input type="tel" id="donor-phone" name="donor-phone" placeholder="" class="controls" maxlength="10" required>
          </label>
          <div class="error-message" id="donor-phone-error"></div>
        </div>
        <!-- item name -->
        <div class="text-field">
          <label for="donor-email">Email of Donor
            <input type="email" id="donor-email" name="donor-email" placeholder="" class="controls" required>
          </label>
          <div class="error-message" id="donor-email-error"></div>
        </div>
        <!-- submit button -->
        <button type="submit" id="submit" class="my-form__button">
          Donate Item
        </button>
      </form>
    </div>
    <!-- side info gif -->
    <div class="info-side">
      <img src="images/fooddonation2.jpg" alt="animated donation image" class="donation-image" />
    </div>
  </div>
  <!-- footer -->
  <div class="myfooter">
    <section class="footer">
      <div class="foot">
        <div class="footer-content">

          <div class="footlinks">
            <h4>Quick Links</h4>
            <ul>
              <li><a href="catalogue.html">Request</a></li>
              <li><a href="aboutus.html">About Us</a></li>
              <li><a href="contactus.html">Contact Us</a></li>
              <li><a href="blog.html">Our Blog</a></li>
              <li><a href="fundus.html">Fund Us</a></li>
            </ul>
          </div>

          <div class="footlinks">
            <h4>Connect</h4>
            <div class="social">
              <a href="" target="_blank"><i class='bx bxl-facebook'></i></a>
              <a href="" target="_blank"><i class='bx bxl-instagram'></i></a>
              <a href="" target="_blank"><i class='bx bxl-linkedin'></i></a>
              <a href="" target="_blank"><i class='bx bxl-youtube'></i></a>
            </div>
          </div>

        </div>
      </div>

      <div class="end">
        <p>Tel: 024 114 5862 | <a href="mailto:kobbyfrimpz89@gmail.com"
            style="text-decoration: none; color: white;">Email: support@zeroHunger.com</a> | Copyright © 2024 zeroHunger
          | All Rights Reserved <br>Website developed by: zeroHunger | Computer Science Department | KNUST.</p>
      </div>
    </section>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-storage.js"></script>
  <script src="javascript/jqBootstrapValidation.js"></script>
  <!-- <script src="javascript/script-donation-validation.js"></script> -->
  <script type="module" src="javascript/donateDatabase.js"></script>

  <!-- validation script -->
  <script>
    // Firebase configuration
var firebaseConfig = {
    apiKey: "AIzaSyA1sfm2XVLTPEbIVeUAVMvXRV_tFTUyffw",
    authDomain: "zerohunger-f7417.firebaseapp.com",
    databaseURL: "https://zerohunger-f7417-default-rtdb.firebaseio.com",
    projectId: "zerohunger-f7417",
    storageBucket: "zerohunger-f7417.appspot.com",
    messagingSenderId: "477597863714",
    appId: "1:477597863714:web:187661d1cb7c74ed1b1f7b",
    measurementId: "G-7B1F5S2TJB"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  var db = firebase.firestore();
  var storage = firebase.storage();
  
  document.getElementById('donation-form').addEventListener('submit', function (e) {
    e.preventDefault();
    var isValid = validateForm();
    if (isValid) {
      storeData();
    }
  });
  
  function validateForm() {
    var isValid = true;
    var fields = [
      'food-name', 'food-type', 'mandate', 'expdate',
      'foodbank-center', 'donatedate', 'time', 'imageFile',
      'message', 'donor-name', 'donor-phone', 'donor-email'
    ];
  
    fields.forEach(function (field) {
      var element = document.getElementById(field);
      var errorElement = document.getElementById(field + '-error');
      if (element.value.trim() === '') {
        element.classList.add('is-invalid');
        errorElement.textContent = 'This field is required';
        isValid = false;
      } else {
        element.classList.remove('is-invalid');
        errorElement.textContent = '';
      }
    });
  
    return isValid;
  }
  
  function storeData() {
    var formData = new FormData(document.getElementById('donation-form'));
    var imageFile = formData.get('imageFile');
  
    // Store image in Firebase Storage
    var storageRef = storage.ref('images/' + imageFile.name);
    var uploadTask = storageRef.put(imageFile);
  
    uploadTask.on('state_changed', function(snapshot) {
      // Handle upload progress
    }, function(error) {
      // Handle upload error
      console.error('Image upload failed:', error);
    }, function() {
      // Get download URL and store form data in Firestore
      uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
        db.collection('donations').add({
          foodName: formData.get('food-name'),
          foodType: formData.get('food-type'),
          manufactureDate: formData.get('mandate'),
          expiryDate: formData.get('expdate'),
          foodbankCenter: formData.get('foodbank-center'),
          donationDate: formData.get('donatedate'),
          donationTime: formData.get('time'),
          imageUrl: downloadURL,
          message: formData.get('message'),
          donorName: formData.get('donor-name'),
          donorPhone: formData.get('donor-phone'),
          donorEmail: formData.get('donor-email')
        }).then(function() {
          alert('Donation successfully submitted');
          document.getElementById('donation-form').reset();
        }).catch(function(error) {
          console.error('Error storing data:', error);
        });
      });
    });
  }
  
  </script>
</body>

</html>
